(function(){"use strict";const xe="3.7.5",Lt=xe,$t=typeof atob=="function",Tt=typeof btoa=="function",z=typeof Buffer=="function",Ae=typeof TextDecoder=="function"?new TextDecoder:void 0,Le=typeof TextEncoder=="function"?new TextEncoder:void 0,jt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Z=Array.prototype.slice.call(jt),oe=(e=>{let t={};return e.forEach((r,n)=>t[r]=n),t})(Z),Ct=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,P=String.fromCharCode.bind(String),$e=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Te=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),je=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Ce=e=>{let t,r,n,o,u="";const f=e.length%3;for(let c=0;c<e.length;){if((r=e.charCodeAt(c++))>255||(n=e.charCodeAt(c++))>255||(o=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|o,u+=Z[t>>18&63]+Z[t>>12&63]+Z[t>>6&63]+Z[t&63]}return f?u.slice(0,f-3)+"===".substring(f):u},ce=Tt?e=>btoa(e):z?e=>Buffer.from(e,"binary").toString("base64"):Ce,pe=z?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let n=0,o=e.length;n<o;n+=4096)r.push(P.apply(null,e.subarray(n,n+4096)));return ce(r.join(""))},ie=(e,t=!1)=>t?Te(pe(e)):pe(e),Dt=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?P(192|t>>>6)+P(128|t&63):P(224|t>>>12&15)+P(128|t>>>6&63)+P(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return P(240|t>>>18&7)+P(128|t>>>12&63)+P(128|t>>>6&63)+P(128|t&63)}},Nt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,De=e=>e.replace(Nt,Dt),Ne=z?e=>Buffer.from(e,"utf8").toString("base64"):Le?e=>pe(Le.encode(e)):e=>ce(De(e)),B=(e,t=!1)=>t?Te(Ne(e)):Ne(e),Ie=e=>B(e,!0),It=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,zt=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return P((r>>>10)+55296)+P((r&1023)+56320);case 3:return P((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return P((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},ze=e=>e.replace(It,zt),Be=e=>{if(e=e.replace(/\s+/g,""),!Ct.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r="",n,o;for(let u=0;u<e.length;)t=oe[e.charAt(u++)]<<18|oe[e.charAt(u++)]<<12|(n=oe[e.charAt(u++)])<<6|(o=oe[e.charAt(u++)]),r+=n===64?P(t>>16&255):o===64?P(t>>16&255,t>>8&255):P(t>>16&255,t>>8&255,t&255);return r},he=$t?e=>atob(je(e)):z?e=>Buffer.from(e,"base64").toString("binary"):Be,qe=z?e=>$e(Buffer.from(e,"base64")):e=>$e(he(e).split("").map(t=>t.charCodeAt(0))),Fe=e=>qe(He(e)),Bt=z?e=>Buffer.from(e,"base64").toString("utf8"):Ae?e=>Ae.decode(qe(e)):e=>ze(he(e)),He=e=>je(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),de=e=>Bt(He(e)),qt=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},Ge=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Me=function(){const e=(t,r)=>Object.defineProperty(String.prototype,t,Ge(r));e("fromBase64",function(){return de(this)}),e("toBase64",function(t){return B(this,t)}),e("toBase64URI",function(){return B(this,!0)}),e("toBase64URL",function(){return B(this,!0)}),e("toUint8Array",function(){return Fe(this)})},Ke=function(){const e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,Ge(r));e("toBase64",function(t){return ie(this,t)}),e("toBase64URI",function(){return ie(this,!0)}),e("toBase64URL",function(){return ie(this,!0)})},Ft={version:xe,VERSION:Lt,atob:he,atobPolyfill:Be,btoa:ce,btoaPolyfill:Ce,fromBase64:de,toBase64:B,encode:B,encodeURI:Ie,encodeURL:Ie,utob:De,btou:ze,decode:de,isValid:qt,fromUint8Array:ie,toUint8Array:Fe,extendString:Me,extendUint8Array:Ke,extendBuiltins:()=>{Me(),Ke()}};var Xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ht=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0},ye={},Gt=Object.prototype.hasOwnProperty,Mt;function Ze(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function We(e){try{return encodeURIComponent(e)}catch{return null}}function Kt(e){for(var t=/([^=?#&]+)=?([^&]*)/g,r={},n;n=t.exec(e);){var o=Ze(n[1]),u=Ze(n[2]);o===null||u===null||o in r||(r[o]=u)}return r}function Xt(e,t){t=t||"";var r=[],n,o;typeof t!="string"&&(t="?");for(o in e)if(Gt.call(e,o)){if(n=e[o],!n&&(n===null||n===Mt||isNaN(n))&&(n=""),o=We(o),n=We(n),o===null||n===null)continue;r.push(o+"="+n)}return r.length?t+r.join("&"):""}ye.stringify=Xt,ye.parse=Kt;var Ve=Ht,ae=ye,Zt=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,Ye=/[\n\r\t]/g,Wt=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Je=/:\d+$/,Vt=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Yt=/^[a-zA-Z]:/;function me(e){return(e||"").toString().replace(Zt,"")}var ve=[["#","hash"],["?","query"],function(t,r){return T(r.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Qe={hash:1,query:1};function et(e){var t;typeof window<"u"?t=window:typeof Xe<"u"?t=Xe:typeof self<"u"?t=self:t={};var r=t.location||{};e=e||r;var n={},o=typeof e,u;if(e.protocol==="blob:")n=new j(unescape(e.pathname),{});else if(o==="string"){n=new j(e,{});for(u in Qe)delete n[u]}else if(o==="object"){for(u in e)u in Qe||(n[u]=e[u]);n.slashes===void 0&&(n.slashes=Wt.test(e.href))}return n}function T(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function tt(e,t){e=me(e),e=e.replace(Ye,""),t=t||{};var r=Vt.exec(e),n=r[1]?r[1].toLowerCase():"",o=!!r[2],u=!!r[3],f=0,c;return o?u?(c=r[2]+r[3]+r[4],f=r[2].length+r[3].length):(c=r[2]+r[4],f=r[2].length):u?(c=r[3]+r[4],f=r[3].length):c=r[4],n==="file:"?f>=2&&(c=c.slice(2)):T(n)?c=r[4]:n?o&&(c=c.slice(2)):f>=2&&T(t.protocol)&&(c=r[4]),{protocol:n,slashes:o||T(n),slashesCount:f,rest:c}}function Jt(e,t){if(e==="")return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],u=!1,f=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),f++):f&&(n===0&&(u=!0),r.splice(n,1),f--);return u&&r.unshift(""),(o==="."||o==="..")&&r.push(""),r.join("/")}function j(e,t,r){if(e=me(e),e=e.replace(Ye,""),!(this instanceof j))return new j(e,t,r);var n,o,u,f,c,l,m=ve.slice(),g=typeof t,d=this,b=0;for(g!=="object"&&g!=="string"&&(r=t,t=null),r&&typeof r!="function"&&(r=ae.parse),t=et(t),o=tt(e||"",t),n=!o.protocol&&!o.slashes,d.slashes=o.slashes||n&&t.slashes,d.protocol=o.protocol||t.protocol||"",e=o.rest,(o.protocol==="file:"&&(o.slashesCount!==2||Yt.test(e))||!o.slashes&&(o.protocol||o.slashesCount<2||!T(d.protocol)))&&(m[3]=[/(.*)/,"pathname"]);b<m.length;b++){if(f=m[b],typeof f=="function"){e=f(e,d);continue}u=f[0],l=f[1],u!==u?d[l]=e:typeof u=="string"?(c=u==="@"?e.lastIndexOf(u):e.indexOf(u),~c&&(typeof f[2]=="number"?(d[l]=e.slice(0,c),e=e.slice(c+f[2])):(d[l]=e.slice(c),e=e.slice(0,c)))):(c=u.exec(e))&&(d[l]=c[1],e=e.slice(0,c.index)),d[l]=d[l]||n&&f[3]&&t[l]||"",f[4]&&(d[l]=d[l].toLowerCase())}r&&(d.query=r(d.query)),n&&t.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||t.pathname!=="")&&(d.pathname=Jt(d.pathname,t.pathname)),d.pathname.charAt(0)!=="/"&&T(d.protocol)&&(d.pathname="/"+d.pathname),Ve(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(c=d.auth.indexOf(":"),~c?(d.username=d.auth.slice(0,c),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(c+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&T(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function Qt(e,t,r){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(r||ae.parse)(t)),n[e]=t;break;case"port":n[e]=t,Ve(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,Je.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var o=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==o?o+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var u=t.indexOf(":");~u?(n.username=t.slice(0,u),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(u+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var f=0;f<ve.length;f++){var c=ve[f];c[4]&&(n[c[1]]=n[c[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&T(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function er(e){(!e||typeof e!="function")&&(e=ae.stringify);var t,r=this,n=r.host,o=r.protocol;o&&o.charAt(o.length-1)!==":"&&(o+=":");var u=o+(r.protocol&&r.slashes||T(r.protocol)?"//":"");return r.username?(u+=r.username,r.password&&(u+=":"+r.password),u+="@"):r.password?(u+=":"+r.password,u+="@"):r.protocol!=="file:"&&T(r.protocol)&&!n&&r.pathname!=="/"&&(u+="@"),(n[n.length-1]===":"||Je.test(r.hostname)&&!r.port)&&(n+=":"),u+=n+r.pathname,t=typeof r.query=="object"?e(r.query):r.query,t&&(u+=t.charAt(0)!=="?"?"?"+t:t),r.hash&&(u+=r.hash),u}j.prototype={set:Qt,toString:er},j.extractProtocol=tt,j.location=et,j.trimLeft=me,j.qs=ae;var tr=j;function q(e){return q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(e)}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nr(n.key),n)}}function rr(e,t,r){return t&&rt(e.prototype,t),r&&rt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nr(e){var t=or(e,"string");return q(t)==="symbol"?t:String(t)}function or(e,t){if(q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}function ur(e){var t=nt();return function(){var n=V(e),o;if(t){var u=V(this).constructor;o=Reflect.construct(n,arguments,u)}else o=n.apply(this,arguments);return sr(this,o)}}function sr(e,t){if(t&&(q(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lr(e)}function lr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e){var t=typeof Map=="function"?new Map:void 0;return ge=function(n){if(n===null||!fr(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,o)}function o(){return ue(n,arguments,V(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),W(o,n)},ge(e)}function ue(e,t,r){return nt()?ue=Reflect.construct.bind():ue=function(o,u,f){var c=[null];c.push.apply(c,u);var l=Function.bind.apply(o,c),m=new l;return f&&W(m,f.prototype),m},ue.apply(null,arguments)}function nt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fr(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},W(e,t)}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},V(e)}var se=function(e){ar(r,e);var t=ur(r);function r(n){var o,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(ir(this,r),o=t.call(this,n),o.originalRequest=f,o.originalResponse=c,o.causingError=u,u!=null&&(n+=", caused by ".concat(u.toString())),f!=null){var l=f.getHeader("X-Request-ID")||"n/a",m=f.getMethod(),g=f.getURL(),d=c?c.getStatus():"n/a",b=c?c.getBody()||"":"n/a";n+=", originated from request (method: ".concat(m,", url: ").concat(g,", response code: ").concat(d,", response text: ").concat(b,", request id: ").concat(l,")")}return o.message=n,o}return rr(r)}(ge(Error));function Pn(e){}function cr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})}function _e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_e=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(s,i,a){s[i]=a.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",f=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(s,i,a){return Object.defineProperty(s,i,{value:a,enumerable:!0,configurable:!0,writable:!0}),s[i]}try{l({},"")}catch{l=function(a,p,y){return a[p]=y}}function m(s,i,a,p){var y=i&&i.prototype instanceof b?i:b,h=Object.create(y.prototype),v=new N(p||[]);return n(h,"_invoke",{value:Re(s,a,v)}),h}function g(s,i,a){try{return{type:"normal",arg:s.call(i,a)}}catch(p){return{type:"throw",arg:p}}}e.wrap=m;var d={};function b(){}function R(){}function S(){}var O={};l(O,u,function(){return this});var $=Object.getPrototypeOf,L=$&&$($(I([])));L&&L!==t&&r.call(L,u)&&(O=L);var U=S.prototype=b.prototype=Object.create(O);function C(s){["next","throw","return"].forEach(function(i){l(s,i,function(a){return this._invoke(i,a)})})}function A(s,i){function a(y,h,v,_){var w=g(s[y],s,h);if(w.type!=="throw"){var k=w.arg,E=k.value;return E&&F(E)=="object"&&r.call(E,"__await")?i.resolve(E.__await).then(function(x){a("next",x,v,_)},function(x){a("throw",x,v,_)}):i.resolve(E).then(function(x){k.value=x,v(k)},function(x){return a("throw",x,v,_)})}_(w.arg)}var p;n(this,"_invoke",{value:function(h,v){function _(){return new i(function(w,k){a(h,v,w,k)})}return p=p?p.then(_,_):_()}})}function Re(s,i,a){var p="suspendedStart";return function(y,h){if(p==="executing")throw new Error("Generator is already running");if(p==="completed"){if(y==="throw")throw h;return ne()}for(a.method=y,a.arg=h;;){var v=a.delegate;if(v){var _=re(v,a);if(_){if(_===d)continue;return _}}if(a.method==="next")a.sent=a._sent=a.arg;else if(a.method==="throw"){if(p==="suspendedStart")throw p="completed",a.arg;a.dispatchException(a.arg)}else a.method==="return"&&a.abrupt("return",a.arg);p="executing";var w=g(s,i,a);if(w.type==="normal"){if(p=a.done?"completed":"suspendedYield",w.arg===d)continue;return{value:w.arg,done:a.done}}w.type==="throw"&&(p="completed",a.method="throw",a.arg=w.arg)}}}function re(s,i){var a=i.method,p=s.iterator[a];if(p===void 0)return i.delegate=null,a==="throw"&&s.iterator.return&&(i.method="return",i.arg=void 0,re(s,i),i.method==="throw")||a!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),d;var y=g(p,s.iterator,i.arg);if(y.type==="throw")return i.method="throw",i.arg=y.arg,i.delegate=null,d;var h=y.arg;return h?h.done?(i[s.resultName]=h.value,i.next=s.nextLoc,i.method!=="return"&&(i.method="next",i.arg=void 0),i.delegate=null,d):h:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,d)}function ke(s){var i={tryLoc:s[0]};1 in s&&(i.catchLoc=s[1]),2 in s&&(i.finallyLoc=s[2],i.afterLoc=s[3]),this.tryEntries.push(i)}function D(s){var i=s.completion||{};i.type="normal",delete i.arg,s.completion=i}function N(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(ke,this),this.reset(!0)}function I(s){if(s){var i=s[u];if(i)return i.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var a=-1,p=function y(){for(;++a<s.length;)if(r.call(s,a))return y.value=s[a],y.done=!1,y;return y.value=void 0,y.done=!0,y};return p.next=p}}return{next:ne}}function ne(){return{value:void 0,done:!0}}return R.prototype=S,n(U,"constructor",{value:S,configurable:!0}),n(S,"constructor",{value:R,configurable:!0}),R.displayName=l(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(s){var i=typeof s=="function"&&s.constructor;return!!i&&(i===R||(i.displayName||i.name)==="GeneratorFunction")},e.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,S):(s.__proto__=S,l(s,c,"GeneratorFunction")),s.prototype=Object.create(U),s},e.awrap=function(s){return{__await:s}},C(A.prototype),l(A.prototype,f,function(){return this}),e.AsyncIterator=A,e.async=function(s,i,a,p,y){y===void 0&&(y=Promise);var h=new A(m(s,i,a,p),y);return e.isGeneratorFunction(i)?h:h.next().then(function(v){return v.done?v.value:h.next()})},C(U),l(U,c,"Generator"),l(U,u,function(){return this}),l(U,"toString",function(){return"[object Generator]"}),e.keys=function(s){var i=Object(s),a=[];for(var p in i)a.push(p);return a.reverse(),function y(){for(;a.length;){var h=a.pop();if(h in i)return y.value=h,y.done=!1,y}return y.done=!0,y}},e.values=I,N.prototype={constructor:N,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!i)for(var a in this)a.charAt(0)==="t"&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=void 0)},stop:function(){this.done=!0;var i=this.tryEntries[0].completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function p(k,E){return v.type="throw",v.arg=i,a.next=k,E&&(a.method="next",a.arg=void 0),!!E}for(var y=this.tryEntries.length-1;y>=0;--y){var h=this.tryEntries[y],v=h.completion;if(h.tryLoc==="root")return p("end");if(h.tryLoc<=this.prev){var _=r.call(h,"catchLoc"),w=r.call(h,"finallyLoc");if(_&&w){if(this.prev<h.catchLoc)return p(h.catchLoc,!0);if(this.prev<h.finallyLoc)return p(h.finallyLoc)}else if(_){if(this.prev<h.catchLoc)return p(h.catchLoc,!0)}else{if(!w)throw new Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return p(h.finallyLoc)}}}},abrupt:function(i,a){for(var p=this.tryEntries.length-1;p>=0;--p){var y=this.tryEntries[p];if(y.tryLoc<=this.prev&&r.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var h=y;break}}h&&(i==="break"||i==="continue")&&h.tryLoc<=a&&a<=h.finallyLoc&&(h=null);var v=h?h.completion:{};return v.type=i,v.arg=a,h?(this.method="next",this.next=h.finallyLoc,d):this.complete(v)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),d},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.finallyLoc===i)return this.complete(p.completion,p.afterLoc),D(p),d}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.tryLoc===i){var y=p.completion;if(y.type==="throw"){var h=y.arg;D(p)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(i,a,p){return this.delegate={iterator:I(i),resultName:a,nextLoc:p},this.method==="next"&&(this.arg=void 0),d}},e}function ot(e,t,r,n,o,u,f){try{var c=e[u](f),l=c.value}catch(m){r(m);return}c.done?t(l):Promise.resolve(l).then(n,o)}function pr(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var u=e.apply(t,r);function f(l){ot(u,n,o,f,c,"next",l)}function c(l){ot(u,n,o,f,c,"throw",l)}f(void 0)})}}function it(e,t){return mr(e)||yr(e,t)||dr(e,t)||hr()}function hr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dr(e,t){if(!!e){if(typeof e=="string")return at(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return at(e,t)}}function at(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yr(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,u,f,c=[],l=!0,m=!1;try{if(u=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=u.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(g){m=!0,o=g}finally{try{if(!l&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(m)throw o}}return c}}function mr(e){if(Array.isArray(e))return e}function F(e){return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(e)}function ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ut(Object(r),!0).forEach(function(n){vr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vr(e,t,r){return t=lt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lt(n.key),n)}}function _r(e,t,r){return t&&st(e.prototype,t),r&&st(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lt(e){var t=br(e,"string");return F(t)==="symbol"?t:String(t)}function br(e,t){if(F(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wr={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},le=function(){function e(t,r){gr(this,e),"resume"in r&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=r,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return _r(e,[{key:"findPreviousUploads",value:function(){var r=this;return this.options.fingerprint(this.file,this.options).then(function(n){return r._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(r){this.url=r.uploadUrl||null,this._parallelUploadUrls=r.parallelUploadUrls||null,this._urlStorageKey=r.urlStorageKey}},{key:"start",value:function(){var r=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var o=this.options.retryDelays;if(o!=null&&Object.prototype.toString.call(o)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var u=0,f=["uploadUrl","uploadSize","uploadLengthDeferred"];u<f.length;u++){var c=f[u];if(this.options[c]){this._emitError(new Error("tus: cannot use the ".concat(c," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(l){return r._fingerprint=l,r._source?r._source:r.options.fileReader.openFile(n,r.options.chunkSize)}).then(function(l){if(r._source=l,r.options.uploadLengthDeferred)r._size=null;else if(r.options.uploadSize!=null){if(r._size=Number(r.options.uploadSize),Number.isNaN(r._size)){r._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(r._size=r._source.size,r._size==null){r._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}r.options.parallelUploads>1||r._parallelUploadUrls!=null?r._startParallelUpload():r._startSingleUpload()}).catch(function(l){r._emitError(l)})}},{key:"_startParallelUpload",value:function(){var r,n=this,o=this._size,u=0;this._parallelUploads=[];var f=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,c=(r=this.options.parallelUploadBoundaries)!==null&&r!==void 0?r:Ur(this._source.size,f);this._parallelUploadUrls&&c.forEach(function(g,d){g.uploadUrl=n._parallelUploadUrls[d]||null}),this._parallelUploadUrls=new Array(c.length);var l=c.map(function(g,d){var b=0;return n._source.slice(g.start,g.end).then(function(R){var S=R.value;return new Promise(function(O,$){var L=H(H({},n.options),{},{uploadUrl:g.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:H(H({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:O,onError:$,onProgress:function(A){u=u-b+A,b=A,n._emitProgress(u,o)},onUploadUrlAvailable:function(){n._parallelUploadUrls[d]=U.url,n._parallelUploadUrls.filter(function(A){return Boolean(A)}).length===c.length&&n._saveUploadInUrlStorage()}}),U=new e(S,L);U.start(),n._parallelUploads.push(U)})})}),m;Promise.all(l).then(function(){m=n._openRequest("POST",n.options.endpoint),m.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var g=ft(n.options.metadata);return g!==""&&m.setHeader("Upload-Metadata",g),n._sendRequest(m,null)}).then(function(g){if(!G(g.getStatus(),200)){n._emitHttpError(m,g,"tus: unexpected response while creating upload");return}var d=g.getHeader("Location");if(d==null){n._emitHttpError(m,g,"tus: invalid or missing Location header");return}n.url=dt(n.options.endpoint,d),"Created upload at ".concat(n.url),n._emitSuccess()}).catch(function(g){n._emitError(g)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(r){var n=this;return this._parallelUploads!=null&&this._parallelUploads.forEach(function(o){o.abort(r)}),this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!r||this.url==null?Promise.resolve():e.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(r,n,o,u){this._emitError(new se(o,u,r,n))}},{key:"_emitError",value:function(r){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var o=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(o&&(this._retryAttempt=0),ht(r,this._retryAttempt,this.options)){var u=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},u);return}}if(typeof this.options.onError=="function")this.options.onError(r);else throw r}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess()}},{key:"_emitProgress",value:function(r,n){typeof this.options.onProgress=="function"&&this.options.onProgress(r,n)}},{key:"_emitChunkComplete",value:function(r,n,o){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(r,n,o)}},{key:"_createUpload",value:function(){var r=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length",1):n.setHeader("Upload-Length",this._size);var o=ft(this.options.metadata);o!==""&&n.setHeader("Upload-Metadata",o);var u;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,u=this._addChunkToRequest(n)):u=this._sendRequest(n,null),u.then(function(f){if(!G(f.getStatus(),200)){r._emitHttpError(n,f,"tus: unexpected response while creating upload");return}var c=f.getHeader("Location");if(c==null){r._emitHttpError(n,f,"tus: invalid or missing Location header");return}if(r.url=dt(r.options.endpoint,c),"Created upload at ".concat(r.url),typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._size===0){r._emitSuccess(),r._source.close();return}r._saveUploadInUrlStorage().then(function(){r.options.uploadDataDuringCreation?r._handleUploadResponse(n,f):(r._offset=0,r._performUpload())})}).catch(function(f){r._emitHttpError(n,null,"tus: failed to create upload",f)})}},{key:"_resumeUpload",value:function(){var r=this,n=this._openRequest("HEAD",this.url),o=this._sendRequest(n,null);o.then(function(u){var f=u.getStatus();if(!G(f,200)){if(f===423){r._emitHttpError(n,u,"tus: upload is currently locked; retry later");return}if(G(f,400)&&r._removeFromUrlStorage(),!r.options.endpoint){r._emitHttpError(n,u,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}r.url=null,r._createUpload();return}var c=parseInt(u.getHeader("Upload-Offset"),10);if(Number.isNaN(c)){r._emitHttpError(n,u,"tus: invalid or missing offset value");return}var l=parseInt(u.getHeader("Upload-Length"),10);if(Number.isNaN(l)&&!r.options.uploadLengthDeferred){r._emitHttpError(n,u,"tus: invalid or missing length value");return}typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._saveUploadInUrlStorage().then(function(){if(c===l){r._emitProgress(l,l),r._emitSuccess();return}r._offset=c,r._performUpload()})}).catch(function(u){r._emitHttpError(n,null,"tus: failed to resume upload",u)})}},{key:"_performUpload",value:function(){var r=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset",this._offset);var o=this._addChunkToRequest(n);o.then(function(u){if(!G(u.getStatus(),200)){r._emitHttpError(n,u,"tus: unexpected response while uploading chunk");return}r._handleUploadResponse(n,u)}).catch(function(u){r._aborted||r._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(r._offset),u)})}}},{key:"_addChunkToRequest",value:function(r){var n=this,o=this._offset,u=this._offset+this.options.chunkSize;return r.setProgressHandler(function(f){n._emitProgress(o+f,n._size)}),r.setHeader("Content-Type","application/offset+octet-stream"),(u===1/0||u>this._size)&&!this.options.uploadLengthDeferred&&(u=this._size),this._source.slice(o,u).then(function(f){var c=f.value,l=f.done,m=c&&c.size?c.size:0;n.options.uploadLengthDeferred&&l&&(n._size=n._offset+m,r.setHeader("Upload-Length",n._size));var g=n._offset+m;return!n.options.uploadLengthDeferred&&l&&g!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(g," bytes"))):c===null?n._sendRequest(r):(n._emitProgress(n._offset,n._size),n._sendRequest(r,c))})}},{key:"_handleUploadResponse",value:function(r,n){var o=parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(o)){this._emitHttpError(r,n,"tus: invalid or missing offset value");return}if(this._emitProgress(o,this._size),this._emitChunkComplete(o-this._offset,o,this._size),this._offset=o,o===this._size){this._emitSuccess(),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(r,n){var o=ct(r,n,this.options);return this._req=o,o}},{key:"_removeFromUrlStorage",value:function(){var r=this;!this._urlStorageKey||(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){r._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var r=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(o){r._urlStorageKey=o})}},{key:"_sendRequest",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return pt(r,n,this.options)}}],[{key:"terminate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=ct("DELETE",r,n);return pt(o,null,n).then(function(u){if(u.getStatus()!==204)throw new se("tus: unexpected response while terminating upload",null,o,u)}).catch(function(u){if(u instanceof se||(u=new se("tus: failed to terminate upload",u,o,null)),!ht(u,0,n))throw u;var f=n.retryDelays[0],c=n.retryDelays.slice(1),l=H(H({},n),{},{retryDelays:c});return new Promise(function(m){return setTimeout(m,f)}).then(function(){return e.terminate(r,l)})})}}]),e}();function ft(e){return Object.entries(e).map(function(t){var r=it(t,2),n=r[0],o=r[1];return"".concat(n," ").concat(Ft.encode(String(o)))}).join(",")}function G(e,t){return e>=t&&e<t+100}function ct(e,t,r){var n=r.httpStack.createRequest(e,t);n.setHeader("Tus-Resumable","1.0.0");var o=r.headers||{};if(Object.entries(o).forEach(function(f){var c=it(f,2),l=c[0],m=c[1];n.setHeader(l,m)}),r.addRequestId){var u=cr();n.setHeader("X-Request-ID",u)}return n}function pt(e,t,r){return be.apply(this,arguments)}function be(){return be=pr(_e().mark(function e(t,r,n){var o;return _e().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(typeof n.onBeforeRequest!="function"){f.next=3;break}return f.next=3,n.onBeforeRequest(t);case 3:return f.next=5,t.send(r);case 5:if(o=f.sent,typeof n.onAfterResponse!="function"){f.next=9;break}return f.next=9,n.onAfterResponse(t,o);case 9:return f.abrupt("return",o);case 10:case"end":return f.stop()}},e)})),be.apply(this,arguments)}function Sr(){var e=!0;return typeof window<"u"&&"navigator"in window&&window.navigator.onLine===!1&&(e=!1),e}function ht(e,t,r){if(r.retryDelays==null||t>=r.retryDelays.length||e.originalRequest==null)return!1;if(r&&typeof r.onShouldRetry=="function")return r.onShouldRetry(e,t,r);var n=e.originalResponse?e.originalResponse.getStatus():0;return(!G(n,400)||n===409||n===423)&&Sr()}function dt(e,t){return new tr(t,e).toString()}function Ur(e,t){for(var r=Math.floor(e/t),n=[],o=0;o<t;o++)n.push({start:r*o,end:r*(o+1)});return n[t-1].end=e,n}le.defaultOptions=wr;function Y(e){return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(e)}function Pr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Er(n.key),n)}}function Or(e,t,r){return t&&yt(e.prototype,t),r&&yt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Er(e){var t=Rr(e,"string");return Y(t)==="symbol"?t:String(t)}function Rr(e,t){if(Y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kr=function(){function e(){Pr(this,e)}return Or(e,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(r){return Promise.resolve([])}},{key:"removeUpload",value:function(r){return Promise.resolve()}},{key:"addUpload",value:function(r,n){return Promise.resolve(null)}}]),e}();function J(e){return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(e)}function xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lr(n.key),n)}}function Ar(e,t,r){return t&&mt(e.prototype,t),r&&mt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lr(e){var t=$r(e,"string");return J(t)==="symbol"?t:String(t)}function $r(e,t){if(J(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var we=!1;try{we="localStorage"in window;var Se="tusSupport",vt=localStorage.getItem(Se);localStorage.setItem(Se,vt),vt===null&&localStorage.removeItem(Se)}catch(e){if(e.code===e.SECURITY_ERR||e.code===e.QUOTA_EXCEEDED_ERR)we=!1;else throw e}var Tr=we,jr=function(){function e(){xr(this,e)}return Ar(e,[{key:"findAllUploads",value:function(){var r=this._findEntries("tus::");return Promise.resolve(r)}},{key:"findUploadsByFingerprint",value:function(r){var n=this._findEntries("tus::".concat(r,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(r){return localStorage.removeItem(r),Promise.resolve()}},{key:"addUpload",value:function(r,n){var o=Math.round(Math.random()*1e12),u="tus::".concat(r,"::").concat(o);return localStorage.setItem(u,JSON.stringify(n)),Promise.resolve(u)}},{key:"_findEntries",value:function(r){for(var n=[],o=0;o<localStorage.length;o++){var u=localStorage.key(o);if(u.indexOf(r)===0)try{var f=JSON.parse(localStorage.getItem(u));f.urlStorageKey=u,n.push(f)}catch{}}return n}}]),e}();function Q(e){return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(e)}function Ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cr(n.key),n)}}function Pe(e,t,r){return t&&gt(e.prototype,t),r&&gt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cr(e){var t=Dr(e,"string");return Q(t)==="symbol"?t:String(t)}function Dr(e,t){if(Q(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nr=function(){function e(){Ue(this,e)}return Pe(e,[{key:"createRequest",value:function(r,n){return new Ir(r,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),e}(),Ir=function(){function e(t,r){Ue(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,r,!0),this._method=t,this._url=r,this._headers={}}return Pe(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(r,n){this._xhr.setRequestHeader(r,n),this._headers[r]=n}},{key:"getHeader",value:function(r){return this._headers[r]}},{key:"setProgressHandler",value:function(r){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){!n.lengthComputable||r(n.loaded)})}},{key:"send",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(o,u){r._xhr.onload=function(){o(new zr(r._xhr))},r._xhr.onerror=function(f){u(f)},r._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),zr=function(){function e(t){Ue(this,e),this._xhr=t}return Pe(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(r){return this._xhr.getResponseHeader(r)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),_t=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function Br(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var o=n.response;t(o)},n.onerror=function(o){r(o)},n.open("GET",e),n.send()})}var qr=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function Fr(e){return new Promise(function(t,r){var n=new FileReader;n.onload=function(){var o=new Uint8Array(n.result);t({value:o})},n.onerror=function(o){r(o)},n.readAsArrayBuffer(e)})}function ee(e){return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}function Hr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mr(n.key),n)}}function Gr(e,t,r){return t&&bt(e.prototype,t),r&&bt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mr(e){var t=Kr(e,"string");return ee(t)==="symbol"?t:String(t)}function Kr(e,t){if(ee(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ee(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wt=function(){function e(t){Hr(this,e),this._file=t,this.size=t.size}return Gr(e,[{key:"slice",value:function(r,n){if(qr())return Fr(this._file.slice(r,n));var o=this._file.slice(r,n),u=n>=this.size;return Promise.resolve({value:o,done:u})}},{key:"close",value:function(){}}]),e}();function te(e){return te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(e)}function Xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wr(n.key),n)}}function Zr(e,t,r){return t&&St(e.prototype,t),r&&St(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wr(e){var t=Vr(e,"string");return te(t)==="symbol"?t:String(t)}function Vr(e,t){if(te(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(te(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ut(e){return e===void 0?0:e.size!==void 0?e.size:e.length}function Yr(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}throw new Error("Unknown data type")}var Jr=function(){function e(t){Xr(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}return Zr(e,[{key:"slice",value:function(r,n){return r<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(r,n)}},{key:"_readUntilEnoughDataOrDone",value:function(r,n){var o=this,u=n<=this._bufferOffset+Ut(this._buffer);if(this._done||u){var f=this._getDataFromBuffer(r,n),c=f==null?this._done:!1;return Promise.resolve({value:f,done:c})}return this._reader.read().then(function(l){var m=l.value,g=l.done;return g?o._done=!0:o._buffer===void 0?o._buffer=m:o._buffer=Yr(o._buffer,m),o._readUntilEnoughDataOrDone(r,n)})}},{key:"_getDataFromBuffer",value:function(r,n){r>this._bufferOffset&&(this._buffer=this._buffer.slice(r-this._bufferOffset),this._bufferOffset=r);var o=Ut(this._buffer)===0;return this._done&&o?null:this._buffer.slice(0,n-r)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}]),e}();function M(e){return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(e)}function Oe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Oe=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(s,i,a){s[i]=a.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",f=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(s,i,a){return Object.defineProperty(s,i,{value:a,enumerable:!0,configurable:!0,writable:!0}),s[i]}try{l({},"")}catch{l=function(a,p,y){return a[p]=y}}function m(s,i,a,p){var y=i&&i.prototype instanceof b?i:b,h=Object.create(y.prototype),v=new N(p||[]);return n(h,"_invoke",{value:Re(s,a,v)}),h}function g(s,i,a){try{return{type:"normal",arg:s.call(i,a)}}catch(p){return{type:"throw",arg:p}}}e.wrap=m;var d={};function b(){}function R(){}function S(){}var O={};l(O,u,function(){return this});var $=Object.getPrototypeOf,L=$&&$($(I([])));L&&L!==t&&r.call(L,u)&&(O=L);var U=S.prototype=b.prototype=Object.create(O);function C(s){["next","throw","return"].forEach(function(i){l(s,i,function(a){return this._invoke(i,a)})})}function A(s,i){function a(y,h,v,_){var w=g(s[y],s,h);if(w.type!=="throw"){var k=w.arg,E=k.value;return E&&M(E)=="object"&&r.call(E,"__await")?i.resolve(E.__await).then(function(x){a("next",x,v,_)},function(x){a("throw",x,v,_)}):i.resolve(E).then(function(x){k.value=x,v(k)},function(x){return a("throw",x,v,_)})}_(w.arg)}var p;n(this,"_invoke",{value:function(h,v){function _(){return new i(function(w,k){a(h,v,w,k)})}return p=p?p.then(_,_):_()}})}function Re(s,i,a){var p="suspendedStart";return function(y,h){if(p==="executing")throw new Error("Generator is already running");if(p==="completed"){if(y==="throw")throw h;return ne()}for(a.method=y,a.arg=h;;){var v=a.delegate;if(v){var _=re(v,a);if(_){if(_===d)continue;return _}}if(a.method==="next")a.sent=a._sent=a.arg;else if(a.method==="throw"){if(p==="suspendedStart")throw p="completed",a.arg;a.dispatchException(a.arg)}else a.method==="return"&&a.abrupt("return",a.arg);p="executing";var w=g(s,i,a);if(w.type==="normal"){if(p=a.done?"completed":"suspendedYield",w.arg===d)continue;return{value:w.arg,done:a.done}}w.type==="throw"&&(p="completed",a.method="throw",a.arg=w.arg)}}}function re(s,i){var a=i.method,p=s.iterator[a];if(p===void 0)return i.delegate=null,a==="throw"&&s.iterator.return&&(i.method="return",i.arg=void 0,re(s,i),i.method==="throw")||a!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),d;var y=g(p,s.iterator,i.arg);if(y.type==="throw")return i.method="throw",i.arg=y.arg,i.delegate=null,d;var h=y.arg;return h?h.done?(i[s.resultName]=h.value,i.next=s.nextLoc,i.method!=="return"&&(i.method="next",i.arg=void 0),i.delegate=null,d):h:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,d)}function ke(s){var i={tryLoc:s[0]};1 in s&&(i.catchLoc=s[1]),2 in s&&(i.finallyLoc=s[2],i.afterLoc=s[3]),this.tryEntries.push(i)}function D(s){var i=s.completion||{};i.type="normal",delete i.arg,s.completion=i}function N(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(ke,this),this.reset(!0)}function I(s){if(s){var i=s[u];if(i)return i.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var a=-1,p=function y(){for(;++a<s.length;)if(r.call(s,a))return y.value=s[a],y.done=!1,y;return y.value=void 0,y.done=!0,y};return p.next=p}}return{next:ne}}function ne(){return{value:void 0,done:!0}}return R.prototype=S,n(U,"constructor",{value:S,configurable:!0}),n(S,"constructor",{value:R,configurable:!0}),R.displayName=l(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(s){var i=typeof s=="function"&&s.constructor;return!!i&&(i===R||(i.displayName||i.name)==="GeneratorFunction")},e.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,S):(s.__proto__=S,l(s,c,"GeneratorFunction")),s.prototype=Object.create(U),s},e.awrap=function(s){return{__await:s}},C(A.prototype),l(A.prototype,f,function(){return this}),e.AsyncIterator=A,e.async=function(s,i,a,p,y){y===void 0&&(y=Promise);var h=new A(m(s,i,a,p),y);return e.isGeneratorFunction(i)?h:h.next().then(function(v){return v.done?v.value:h.next()})},C(U),l(U,c,"Generator"),l(U,u,function(){return this}),l(U,"toString",function(){return"[object Generator]"}),e.keys=function(s){var i=Object(s),a=[];for(var p in i)a.push(p);return a.reverse(),function y(){for(;a.length;){var h=a.pop();if(h in i)return y.value=h,y.done=!1,y}return y.done=!0,y}},e.values=I,N.prototype={constructor:N,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!i)for(var a in this)a.charAt(0)==="t"&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=void 0)},stop:function(){this.done=!0;var i=this.tryEntries[0].completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function p(k,E){return v.type="throw",v.arg=i,a.next=k,E&&(a.method="next",a.arg=void 0),!!E}for(var y=this.tryEntries.length-1;y>=0;--y){var h=this.tryEntries[y],v=h.completion;if(h.tryLoc==="root")return p("end");if(h.tryLoc<=this.prev){var _=r.call(h,"catchLoc"),w=r.call(h,"finallyLoc");if(_&&w){if(this.prev<h.catchLoc)return p(h.catchLoc,!0);if(this.prev<h.finallyLoc)return p(h.finallyLoc)}else if(_){if(this.prev<h.catchLoc)return p(h.catchLoc,!0)}else{if(!w)throw new Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return p(h.finallyLoc)}}}},abrupt:function(i,a){for(var p=this.tryEntries.length-1;p>=0;--p){var y=this.tryEntries[p];if(y.tryLoc<=this.prev&&r.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var h=y;break}}h&&(i==="break"||i==="continue")&&h.tryLoc<=a&&a<=h.finallyLoc&&(h=null);var v=h?h.completion:{};return v.type=i,v.arg=a,h?(this.method="next",this.next=h.finallyLoc,d):this.complete(v)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),d},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.finallyLoc===i)return this.complete(p.completion,p.afterLoc),D(p),d}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.tryLoc===i){var y=p.completion;if(y.type==="throw"){var h=y.arg;D(p)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(i,a,p){return this.delegate={iterator:I(i),resultName:a,nextLoc:p},this.method==="next"&&(this.arg=void 0),d}},e}function Pt(e,t,r,n,o,u,f){try{var c=e[u](f),l=c.value}catch(m){r(m);return}c.done?t(l):Promise.resolve(l).then(n,o)}function Qr(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var u=e.apply(t,r);function f(l){Pt(u,n,o,f,c,"next",l)}function c(l){Pt(u,n,o,f,c,"throw",l)}f(void 0)})}}function en(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rn(n.key),n)}}function tn(e,t,r){return t&&Ot(e.prototype,t),r&&Ot(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rn(e){var t=nn(e,"string");return M(t)==="symbol"?t:String(t)}function nn(e,t){if(M(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var on=function(){function e(){en(this,e)}return tn(e,[{key:"openFile",value:function(){var t=Qr(Oe().mark(function n(o,u){var f;return Oe().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(_t()&&o&&typeof o.uri<"u")){l.next=11;break}return l.prev=1,l.next=4,Br(o.uri);case 4:return f=l.sent,l.abrupt("return",new wt(f));case 8:throw l.prev=8,l.t0=l.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(l.t0));case 11:if(!(typeof o.slice=="function"&&typeof o.size<"u")){l.next=13;break}return l.abrupt("return",Promise.resolve(new wt(o)));case 13:if(typeof o.read!="function"){l.next=18;break}if(u=Number(u),Number.isFinite(u)){l.next=17;break}return l.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return l.abrupt("return",Promise.resolve(new Jr(o,u)));case 18:return l.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return l.stop()}},n,null,[[1,8]])}));function r(n,o){return t.apply(this,arguments)}return r}()}]),e}();function an(e,t){return _t()?Promise.resolve(un(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}function un(e,t){var r=e.exif?sn(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",r,t.endpoint].join("/")}function sn(e){var t=0;if(e.length===0)return t;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return t}function K(e){return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(e)}function ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kt(n.key),n)}}function fn(e,t,r){return t&&Et(e.prototype,t),r&&Et(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ee(e,t)}function Ee(e,t){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ee(e,t)}function pn(e){var t=yn();return function(){var n=fe(e),o;if(t){var u=fe(this).constructor;o=Reflect.construct(n,arguments,u)}else o=n.apply(this,arguments);return hn(this,o)}}function hn(e,t){if(t&&(K(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dn(e)}function dn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fe(e)}function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rt(Object(r),!0).forEach(function(n){mn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mn(e,t,r){return t=kt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kt(e){var t=vn(e,"string");return K(t)==="symbol"?t:String(t)}function vn(e,t){if(K(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xt=X(X({},le.defaultOptions),{},{httpStack:new Nr,fileReader:new on,urlStorage:Tr?new jr:new kr,fingerprint:an}),gn=function(e){cn(r,e);var t=pn(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ln(this,r),o=X(X({},xt),o),t.call(this,n,o)}return fn(r,null,[{key:"terminate",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return u=X(X({},xt),u),le.terminate(o,u)}}]),r}(le);function At(e,t,r,n,o,u,f,c){var l=typeof e=="function"?e.options:e;t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),n&&(l.functional=!0),u&&(l._scopeId="data-v-"+u);var m;if(f?(m=function(b){b=b||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!b&&typeof __VUE_SSR_CONTEXT__<"u"&&(b=__VUE_SSR_CONTEXT__),o&&o.call(this,b),b&&b._registeredComponents&&b._registeredComponents.add(f)},l._ssrRegister=m):o&&(m=c?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),m)if(l.functional){l._injectStyles=m;var g=l.render;l.render=function(R,S){return m.call(S),g(R,S)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,m):[m]}return{exports:e,options:l}}var _n=At({extends:"k-upload",methods:{async upload(e){let t=this,{bytes:r}=await this.$api.get("dgtlone/chunky/chunk_size");this.$refs.dialog.open(),this.files=[...e],this.completed={},this.errors=[],this.hasErrors=!1,this.limit&&(this.files=this.files.slice(0,this.limit)),this.total=this.files.length,this.files.forEach(n=>{var c,l,m,g,d,b,R,S;let o=(m=(l=(c=this.options)==null?void 0:c.attributes)==null?void 0:l.template)!=null?m:"",u=(b=(d=(g=this.options)==null?void 0:g.attributes)==null?void 0:d.replace)!=null?b:!1,f=new gn(n,{endpoint:t.$urls.api+"/dgtlone/chunky/upload",chunkSize:r,retryDelays:[0,3e3,5e3,1e4,2e4],removeFingerprintOnSuccess:!0,headers:{"X-CSRF":t.$system.csrf,"X-Target-Path":t.$view.path},metadata:{filename:n.name,filetype:n.type,template:o,replace:!!u},onError:function(O){t.errors.push({file:n,message:O}),t.complete(n,O)},onProgress:function(O,$){var U,C;var L=(O/$*100).toFixed(2);(C=(U=t.$refs[n.name])==null?void 0:U[0])==null||C.set(L)},onSuccess:function(){t.complete(n,!0)}});f.findPreviousUploads().then(function(O){O.length&&f.resumeFromPreviousUpload(O[0]),f.start()}),((S=(R=this.options)==null?void 0:R.attributes)==null?void 0:S.sort)!==void 0&&this.options.attributes.sort++})}}},null,null,!1,null,null,null,null);const bn=_n.exports;var wn=At({extends:"k-file-view",methods:{action(e){switch(e){case"replace":this.$refs.upload.open({url:this.$urls.api+"/"+this.id,accept:"."+this.model.extension+","+this.model.mime,multiple:!1,attributes:{replace:!0}});break}}}},null,null,!1,null,null,null,null);const Sn=wn.exports;panel.plugin("dgtlone/kirby-chunky",{components:{"k-upload":bn,"k-file-view":Sn}})})();
